--[[		file	: xaloy-core-log.lua		author	: drzunny		updated	: 2012-06-30--]]require("libxtools")local xlog = {}-------------- helper functions' declaration --------------local _LOG_PATH_ = "log/"local _HTML_PATH_ = "log/html/"local printdatalocal html_template = [[	<html>		<head>			<title>$title$ test result</title>		</head>		<body>			<h1>$title$ test result</h1>			<hr/>					</body>	</html>]]-------------- xaloy log module api --------------xlog.write = function(txt, without_time)		local env = require("xaloy-core-env")	local datetime = env.getdate()	local f = io.open(_LOG_PATH_ .. datetime.dstr .. ".txt", "a")	if without_time ~= true then		f:write(datetime.logstr + "  |  ")	end	f:write(txt)	f:close()	env = nil	collectgarbage("collect")endxlog.debug = function(obj)	xtools.debug("this object is:")	if type(obj) == "string" or type(obj) == "number" then		print(obj)	else		printdata(obj)	endendxlog.error = function(msg, ...)	xtools.error(string.format(msg, ...))	xlog.write("[ERROR]"..string.format(msg, ...))endxlog.ok = function(msg, ...)	xtools.ok(string.format(msg, ...))	xlog.write("[OK]"..string.format(msg, ...))endxlog.message = function(msg, ...)	xtools.message(string.format(msg, ...))		xlog.write("[MESSAGE]"..string.format(msg, ...))endxlog.log = function(msg, ...)	xtools.printline(string.format(msg, ...))	xlog.write(string.format(msg, ...))endxlog.html = function(xcase, xresult)end-------------- helper functions' implementations --------------printdata = function(data, prefix)	if prefix == nil then		prefix = ''	end		-- print object	for i, v in pairs(data) do						if type(v) == "string" or type(v) == "number" then			print(string.format("%s'%s' = %s", prefix, tostring(i), tostring(v)))		else			print(prefix.."'"..i.."' elements:")			printdata(v, prefix..'\t')		end	endend--------- return xaloy's log module ----------return xlog